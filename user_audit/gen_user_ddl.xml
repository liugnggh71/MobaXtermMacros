<?xml version="1.0" encoding="UTF-8"?>
<macro xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation="../MobaMacro.xsd">
   <name>gen_user_ddl</name>
   <desc>Full code file: gen_user_ddl.sql</desc>
   <environment>Vi</environment>
   <hotkey>0</hotkey>
   <line type="Text">vi gen_user_ddl.sql</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">i</line>
   <line type="Text">clear screen</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">SET LONG 20000 LONGCHUNKSIZE 20000 PAGESIZE 0 LINESIZE 1000 FEEDBACK OFF VERIFY OFF TRIMSPOOL ON</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">column outfile new_value outfile noprint</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">SELECT    SUBSTR (host_name,</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">                  1,</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">                  INSTR (host_name || '.',</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">                         '.',</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">                         1,</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">                         1))</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">       || '_'</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">       || instance_name</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">       || '_'</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">       || '&amp;username'</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">       || '_'</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">       || TO_CHAR (SYSDATE, 'yyyymmddhh24miss')</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">           outfile</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">  FROM v$instance;</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">define outfile</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">host mkdir user_definition</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">spool user_definition/&amp;&amp;outfile..gen</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text"> </line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">BEGIN</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">   DBMS_METADATA.set_transform_param (DBMS_METADATA.session_transform, 'SQLTERMINATOR', true);</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">   DBMS_METADATA.set_transform_param (DBMS_METADATA.session_transform, 'PRETTY', true);</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">END;</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">/</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text"> </line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">SELECT dbms_metadata.get_ddl('USER',upper('&amp;&amp;username')) FROM dual;</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">SELECT DBMS_METADATA.GET_GRANTED_DDL('SYSTEM_GRANT',upper('&amp;&amp;username')) from dual;</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">SELECT DBMS_METADATA.GET_GRANTED_DDL('ROLE_GRANT','upper('&amp;&amp;username')) from dual;</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">SELECT DBMS_METADATA.GET_GRANTED_DDL('OBJECT_GRANT',upper('&amp;&amp;username')) from dual;</line>
   <line type="KeyPress">RETURN</line>
   <line type="Text">spool off</line>
   <line type="KeyPress">RETURN</line>
   <line type="KeyPress">ESCAPE</line>
   <line type="KeyPress">COLON</line>
   <line type="Text">x</line>
   <line type="KeyPress">RETURN</line>
</macro>
